<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Check VFK at map</title>
    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.15.1/build/ol.js"></script>
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.15.1/css/ol.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .map {
            /* width: 100%;
            height: 1000px; */
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
        }
    </style>
</head>

<body>
    <div id="map" class="map"></div>
    <script>
        //alert('This application was created for checkinng VFK files');

        const vectorSource = new ol.source.Vector({
            title: 'added Layer',
            source: new ol.source.Vector({
                format: ol.format.GeoJSON()
            })
        })

        function styleFunction(feature) {
            var text = String(feature.get('id'));
            return new ol.style.Style({
                stroke: new ol.style.Stroke({
                    width: 8,
                    color: 'red',
                }),
                text: new ol.style.Text({
                    text: text,
                    scale: map.getView().getZoom() > 18 ? 3 : 1,
                    fill: new ol.style.Fill({
                        color: 'red'
                    }),
                    stroke: new ol.style.Stroke({
                        color: 'white',
                        width: map.getView().getZoom() > 18 ? 2 : 1
                    })
                })
            })
        };

        const vectorLayer = new ol.layer.Vector({
            source: vectorSource,
            style: styleFunction
        });

        const tiledosm = new ol.layer.Tile({
            source: new ol.source.OSM(),
        })

        const map = new ol.Map({
            layers: [
                tiledosm,
                vectorLayer
            ],
            target: 'map',
            view: new ol.View({
                center: [1860512.38, 6316573.03],
                zoom: 10,
            }),
        });

        $.ajax({
            type: 'GET',
            url: 'http://localhost:6789/get_layer',
            dataType: 'json',
            success: function (data) {
                var features = (new ol.format.GeoJSON()).readFeatures(data)
                vectorSource.addFeatures(features)
            },
            error: function (error) {
                alert('error :: ' + eval(error));
            }
        })

    </script>
</body>

</html>